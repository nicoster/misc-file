<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<!--------------------------------------------------------------------------->  
<!--                           INTRODUCTION                                

 The Code Project article submission template (HTML version)

Using this template will help us post your article sooner. To use, just 
follow the 3 easy steps below:
 
     1. Fill in the article description details
     2. Add links to your images and downloads
     3. Include the main article text

That's all there is to it! All formatting will be done by our submission
scripts and style sheets. 

-->  
<!--------------------------------------------------------------------------->  
<!--                        IGNORE THIS SECTION                            -->
<html>
<head>
<title>The Code Project</title>
<Style>
BODY, P, TD { font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 10pt }
H2,H3,H4,H5 { color: #ff9900; font-weight: bold; }
H2 { font-size: 13pt; }
H3 { font-size: 12pt; }
H4 { font-size: 10pt; color: black; }
PRE { BACKGROUND-COLOR: #FBEDBB; FONT-FAMILY: "Courier New", Courier, mono; WHITE-SPACE: pre; }
CODE { COLOR: #990000; FONT-FAMILY: "Courier New", Courier, mono; }
</style>
<link rel="stylesheet" type="text/css" href="http://www.codeproject.com/App_Themes/NetCommunity/CodeProject.css">
</head>
<body bgcolor="#FFFFFF" color=#000000>
<!--------------------------------------------------------------------------->  


<!-------------------------------     STEP 1      --------------------------->
<!--  Fill in the details (CodeProject will reformat this section for you) -->

<pre>
Title:       Article Title Goes Here
Author:      Author Name 
Email:       author@email.com
Member ID:   12345
Language:    C++, C# 2.0 etc
Platform:    Windows, .NET 3.0 etc
Technology:  ASP.NET, GDI+
Level:       Beginner, Intermediate, Advanced
Description: An article on something-or-other
Section      Suggest a section...
SubSection   Suggest a subsection...
License:     Choose your license (<a href="http://www.codeproject.com/info/licenses.aspx">CPOL, CPL, MIT, etc</a>)
</pre>

<!-------------------------------     STEP 2      --------------------------->
<!--  Include download and sample image information.                       --> 

<ul class=download>
<li><a href="Article_demo.zip">Download demo project - XXX Kb </a></li>
<li><a href="Article_src.zip">Download source - XXX Kb</a></li>
</ul>

<p><img src="Article.gif" alt="Sample Image - maximum width is 600 pixels" width=400 height=200></p>


<!-------------------------------     STEP 3      --------------------------->

<!--  Add the article text. Please use simple formatting (<h2>, <p> etc)   --> 

<h2>Introduction</h2>

<p>Maybe you already knows the undocumented Windows API DnsFlushResolverCache() in dnsapi.dll, which is to flush DNS cache in Windows. To flush DNS cache in wininet.dll, there's no API to do this. Here I present a really undocumented method to achieve this goal.

<h2>Background (optional)</h2>
<p>I need to clear wininet DNS cache in my project for failover support. Google only leads me to 2 registry keys DnsCacheTimeout and ServerInfoTimeOut under:
<p>HKEY_CURRENT_USER\SOFTWARE\Microsoft\Windows\CurrentVersion\Internet Settings 
<p>But these 2 keys are basically for changing the timeout value. 
<p>After a lot of windbg and reverse engineering works, I've found there're 2 levels of DNS cache in wininet.dll. 


<h2>Using the Code</h2>

<p>A brief description of how to use the article or code. The class names, the
methods and properties, any tricks or tips.

<p>Blocks of code should be wrapped in &lt;pre> tags like this:

<pre>

//
// Any source code blocks look like this
//

</pre>

<p>Variable or class names should be wrapped in &lt;code> tags like <code>this</code>.

<h2>Points of Interest</h2>

<p>Did you learn anything interesting/fun/annoying while writing the code? Did you
do anything particularly clever or wild or zany?

<h2>History</h2>

<p>Keep a running update of any changes or improvements you've made here.


<!-------------------------------    That's it!   --------------------------->
</body>

</html>
